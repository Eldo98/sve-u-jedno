<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <title>NOU PREMIUM CONSOLE v12.0</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        body { background: #0f1012; color: #f2f3f5; font-family: 'Plus Jakarta Sans', sans-serif; }
        .glass { background: #1e1f22; border: 1px solid rgba(255,255,255,0.05); border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        input, select, textarea { background: #111214 !important; border: 1px solid #313338 !important; color: white !important; padding: 14px; border-radius: 12px; transition: 0.2s; }
        input:focus { border-color: #5865f2 !important; box-shadow: 0 0 0 2px rgba(88,101,242,0.2); outline: none; }
        .nav-btn { background: #2b2d31; padding: 12px 20px; border-radius: 14px; font-weight: 700; font-size: 0.85rem; transition: 0.3s; border: 1px solid transparent; }
        .nav-btn.active { background: #5865f2; color: white; border-color: rgba(255,255,255,0.1); }
        .action-btn { transition: transform 0.1s; font-weight: 800; letter-spacing: 0.5px; }
        .action-btn:active { transform: scale(0.96); }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: #313338; border-radius: 10px; }
        .drop-zone { border: 2px dashed #313338; transition: 0.3s; background: rgba(255,255,255,0.02); }
        .drop-zone:hover { border-color: #5865f2; background: rgba(88,101,242,0.05); }
    </style>
</head>
<body class="p-4 md:p-10">

<div class="max-w-5xl mx-auto">
    <header class="text-center mb-12">
        <h1 class="text-5xl font-extrabold tracking-tighter italic uppercase mb-2">NOU <span class="text-[#5865f2]">Console</span></h1>
        <p class="text-[10px] text-gray-500 font-bold uppercase tracking-[0.6em]">Premium Infrastructure v12.0</p>
        
        <div class="mt-8 flex flex-col md:flex-row justify-center gap-4">
            <input type="text" id="globalUser" placeholder="Tvoj Discord (Ime#0000)" oninput="syncUser()" class="w-full md:w-72 text-center font-bold">
            <div id="stats" class="hidden glass px-6 py-2 flex items-center justify-center gap-4 font-extrabold text-[#5865f2]">
                <span id="statHours">0.00h</span>
            </div>
        </div>
    </header>

    <nav class="flex gap-2 mb-10 overflow-x-auto pb-4 justify-start md:justify-center no-scrollbar">
        <button class="nav-btn active whitespace-nowrap" onclick="openTab('work', this)">RAD</button>
        <button class="nav-btn whitespace-nowrap" onclick="openTab('chat', this)">CHAT</button>
        <button class="nav-btn whitespace-nowrap" onclick="openTab('apply', this)">PRIJAVA</button>
        <button class="nav-btn whitespace-nowrap" onclick="openTab('inv', this)">INVENTAR</button>
        <button class="nav-btn text-yellow-500 whitespace-nowrap" onclick="openTab('admin', this)">ADMIN PANEL</button>
    </nav>

    <main>
        <section id="workTab" class="tab-content">
            <div class="glass p-12 text-center mb-8 border-b-4 border-green-500">
                <div class="flex flex-col md:flex-row gap-4 justify-center">
                    <button onclick="clock(1)" class="action-btn bg-green-600 hover:bg-green-500 px-12 py-5 rounded-2xl text-xl uppercase">START RAD</button>
                    <button onclick="clock(0)" class="action-btn bg-red-600 hover:bg-red-500 px-12 py-5 rounded-2xl text-xl uppercase">STOP RAD</button>
                </div>
            </div>
            <div class="glass p-6"><table class="w-full text-left text-sm font-medium"><tbody id="activeBody" class="divide-y divide-white/5"></tbody></table></div>
        </section>

        <section id="chatTab" class="tab-content hidden">
            <div class="glass p-6 h-[500px] flex flex-col">
                <div id="chatBox" class="flex-1 overflow-y-auto space-y-3 pr-2"></div>
                <div class="mt-6 flex gap-3">
                    <input id="chatIn" placeholder="Napi≈°i ne≈°to..." class="flex-1">
                    <button onclick="sendChat()" class="bg-[#5865f2] px-8 rounded-xl font-black uppercase text-xs">≈†alji</button>
                </div>
            </div>
        </section>

        <section id="applyTab" class="tab-content hidden">
            <div class="glass p-10 max-w-2xl mx-auto border-t-4 border-[#5865f2]">
                <h2 class="text-2xl font-black mb-6 uppercase">Prijava za Tim</h2>
                <div class="space-y-4">
                    <select id="role" class="w-full font-bold"><option>Helper</option><option>Worker</option></select>
                    <textarea id="reason" rows="5" class="w-full" placeholder="Navedi svoje iskustvo i za≈°to te trebamo..."></textarea>
                    <button onclick="submitApp()" class="w-full bg-[#5865f2] py-5 rounded-2xl font-black text-lg uppercase tracking-widest shadow-lg shadow-blue-500/20">Po≈°alji u Discord</button>
                </div>
            </div>
        </section>

        <section id="invTab" class="tab-content hidden space-y-6">
            <div class="glass p-8 grid grid-cols-1 md:grid-cols-3 gap-4 items-end">
                <div><label class="text-[10px] uppercase font-black text-gray-500 ml-2 mb-1 block">Naziv</label><input id="inN" class="w-full"></div>
                <div><label class="text-[10px] uppercase font-black text-gray-500 ml-2 mb-1 block">S/N</label><input id="inS" class="w-full"></div>
                <button onclick="addInv()" class="bg-blue-600 py-4 rounded-xl font-black uppercase text-xs">Dodaj Opremu</button>
            </div>
            <div id="invList" class="grid grid-cols-1 md:grid-cols-3 gap-4"></div>
        </section>

        <section id="adminTab" class="tab-content hidden space-y-8 pb-20">
            <div id="adminAuth" class="glass p-10 text-center max-w-sm mx-auto">
                <input type="password" id="adminPass" placeholder="≈†ifra Panela" class="text-center mb-6 w-full">
                <button onclick="doAdmin()" class="w-full bg-white text-black py-4 rounded-xl font-black uppercase tracking-widest">Prijavi se</button>
            </div>

            <div id="adminPanel" class="hidden space-y-10">
                <div class="glass p-8 border-l-4 border-green-500">
                    <h3 class="font-black text-xs uppercase text-green-500 mb-6 tracking-[0.3em]">Dolazne Prijave</h3>
                    <div id="adminApps" class="space-y-4"></div>
                </div>

                <div class="glass p-8 border-l-4 border-yellow-500">
                    <h3 class="font-black text-xs uppercase text-yellow-500 mb-6 tracking-[0.3em]">Slu≈æbena Obavijest / Alert</h3>
                    <input id="annTitle" placeholder="Naslov poruke" class="mb-3 font-bold">
                    <textarea id="annMsg" placeholder="Sadr≈æaj..." class="mb-4"></textarea>
                    
                    <div class="drop-zone p-10 rounded-2xl mb-6 text-center" id="dropZone" onclick="document.getElementById('fileIn').click()">
                        <p id="dropText" class="text-xs font-bold text-gray-400 uppercase">üì∏ Upload slike (Drag & Drop ili Klik)</p>
                        <input type="file" id="fileIn" class="hidden" accept="image/*" onchange="handleFile(this.files[0])">
                        <img id="preview" class="hidden max-h-48 mx-auto mt-4 rounded-xl border border-white/10 shadow-2xl">
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <button onclick="sendOfficial('ann')" class="bg-yellow-600 py-4 rounded-xl font-black uppercase text-xs">Po≈°alji Obavijest</button>
                        <button onclick="sendOfficial('alert')" class="bg-red-600 py-4 rounded-xl font-black uppercase text-xs">Po≈°alji Hitno</button>
                    </div>
                </div>

                <div class="glass p-8 border-l-4 border-blue-500">
                    <h3 class="font-black text-xs uppercase text-blue-500 mb-6 tracking-[0.3em]">Lista Osoblja i Brisanje</h3>
                    <div id="adminUsersList" class="space-y-2"></div>
                </div>

                <div class="glass p-8 bg-red-900/5 border border-red-900/20">
                    <h3 class="font-black text-[10px] uppercase text-red-500 mb-6">Master Wipe System</h3>
                    <div class="flex flex-wrap gap-4">
                        <button onclick="wipeData('inventar')" class="bg-red-800/20 border border-red-800 text-red-500 px-6 py-2 rounded-lg font-black text-[10px] uppercase">Wipe Inventar</button>
                        <button onclick="wipeData('chat')" class="bg-red-800/20 border border-red-800 text-red-500 px-6 py-2 rounded-lg font-black text-[10px] uppercase">Wipe Chat</button>
                    </div>
                </div>
            </div>
        </section>
    </main>
</div>

<script>
    // FIREBASE
    const firebaseConfig = {
        apiKey: "AIzaSyAoPo3Dj5yoH4sQeTScWZCe-jDDpkDPMt8",
        authDomain: "nou-management.firebaseapp.com",
        databaseURL: "https://nou-management-default-rtdb.firebaseio.com",
        projectId: "nou-management",
        storageBucket: "nou-management.firebasestorage.app",
        messagingSenderId: "1098791447574",
        appId: "1:1098791447574:web:6e4c666d302055658c9937"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // WEBHOOKS
    const WH_RAD = "https://discord.com/api/webhooks/1463866279860633672/CqGRQKkkBYlZkC76HqUZBaHbBuJvjmCEYkF7mZD7zrORhi7KdNA9vhBV_DRL_uTVBTZO";
    const WH_PRIJAVA = "https://discord.com/api/webhooks/1463803834454245406/_UVJ8jv6baedZuYr25uT8S4jPgUkX_KiQtvzTgNpdDRbuHt90K-0-nvHNFURRUxzQmK6";
    const WH_OPREMA = "https://discord.com/api/webhooks/1463955268525228198/84s4OI9mWtiWY17TMqHN2VJ-GUqgzT2-vpIJsYx3-zC-lPFgGdAy73HkvvZZjdCX7nQF";
    const WH_ADMIN = "https://discord.com/api/webhooks/1463869887498817536/gRHBl-FjoQ0hFZhJ3k6qbAkk4adLI-EAPuO94ncVd-8tSd-6LW8AOsxOGnfwJIYVlNNR";

    let tempImg = "";

    function openTab(id, btn) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id+'Tab').classList.remove('hidden');
        btn.classList.add('active');
    }

    const getU = () => document.getElementById('globalUser').value.trim();
    const fix = (n) => n.replace(/[.#$/[\]]/g, '_');

    // RAD SISTEM
    function clock(st) {
        let u = getU(); if(!u) return alert("Unesi Ime!");
        let ref = db.ref('users/'+fix(u));
        if(st===1) {
            ref.update({ status: 'Online', last: Date.now() });
            fetch(WH_RAD, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({content: `üöÄ **${u}** se prijavio.`}) });
        } else {
            ref.once('value', s => {
                let d = s.val(); if(!d || !d.last) return;
                let h = ((Date.now()-d.last)/3600000).toFixed(2);
                let total = (parseFloat(d.hours || 0) + parseFloat(h)).toFixed(2);
                ref.update({ status: 'Offline', hours: total, last: null });
                fetch(WH_RAD, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({content: `‚èπ **${u}** se odjavio. Radio: **${h}h**.`}) });
            });
        }
    }

    // CHAT
    function sendChat() {
        let u = getU(); let t = document.getElementById('chatIn').value; if(!u || !t) return;
        db.ref('chat').push({ u, t }); document.getElementById('chatIn').value = "";
    }
    db.ref('chat').limitToLast(20).on('value', s => {
        let h = ''; s.forEach(c => { h += `<div class="bg-black/20 p-3 rounded-xl border border-white/5 text-sm"><b class="text-[#5865f2] mr-2 text-[10px] uppercase font-black">${c.val().u}:</b> ${c.val().t}</div>`; });
        const b = document.getElementById('chatBox'); b.innerHTML = h; b.scrollTop = b.scrollHeight;
    });

    // PRIJAVA
    function submitApp() {
        let u = getU(); let r = document.getElementById('role').value; let rs = document.getElementById('reason').value;
        if(!u) return;
        db.ref('prijave').push({ u, r, rs });
        fetch(WH_PRIJAVA, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({
            embeds: [{ title: "DOLAZEƒÜA PRIJAVA", color: 5793266, fields: [{name:"Ime", value:u, inline:true}, {name:"Uloga", value:r, inline:true}, {name:"Motivacija", value:rs}] }]
        })});
        alert("Prijava poslana!");
    }

    // INVENTAR
    function addInv() {
        let n = document.getElementById('inN').value; let s = document.getElementById('inS').value;
        if(!n) return;
        db.ref('inventar').push({ n, s });
        fetch(WH_OPREMA, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({content: `üì¶ **NOVI UNOS:** ${n} (S/N: ${s})`}) });
        document.getElementById('inN').value = ""; document.getElementById('inS').value = "";
    }
    db.ref('inventar').on('value', s => {
        let h = ''; s.forEach(c => {
            h += `<div class="glass p-5 relative border border-white/5">
                <button onclick="db.ref('inventar/${c.key}').remove()" class="absolute top-3 right-3 text-red-500 hover:text-red-400 font-bold text-xs uppercase">Obri≈°i</button>
                <div class="text-[10px] font-black text-gray-500 mb-1 uppercase">Oprema</div>
                <div class="font-bold text-blue-400 mb-1">${c.val().n}</div>
                <div class="text-[10px] text-gray-500">S/N: ${c.val().s}</div>
            </div>`;
        });
        document.getElementById('invList').innerHTML = h;
    });

    // ADMIN ODLUKA & LJUDI
    function doAdmin() {
        if(document.getElementById('adminPass').value === "mihatovici_79") {
            document.getElementById('adminAuth').classList.add('hidden');
            document.getElementById('adminPanel').classList.remove('hidden');
            loadAdminData();
        }
    }

    function loadAdminData() {
        // Prijave
        db.ref('prijave').on('value', s => {
            let h = '';
            s.forEach(c => {
                let p = c.val();
                h += `<div class="bg-black/30 p-6 rounded-2xl flex flex-col md:flex-row justify-between items-center gap-4">
                    <div><b class="text-lg">${p.u}</b> <span class="text-gray-500 ml-2">(${p.r})</span><p class="text-xs italic text-gray-400 mt-2">"${p.rs}"</p></div>
                    <div class="flex gap-2 w-full md:w-auto">
                        <button onclick="decision('${c.key}', '${p.u}', 'PRIHVAƒÜENA', 3066993)" class="bg-green-600 flex-1 px-8 py-3 rounded-xl font-black">DA</button>
                        <button onclick="decision('${c.key}', '${p.u}', 'ODBIJENA', 15158332)" class="bg-red-600 flex-1 px-8 py-3 rounded-xl font-black">NE</button>
                    </div>
                </div>`;
            });
            document.getElementById('adminApps').innerHTML = h || '<p class="text-gray-600 text-xs italic">Nema aktivnih prijava.</p>';
        });

        // Svi korisnici (za brisanje)
        db.ref('users').on('value', s => {
            let h = '';
            s.forEach(c => {
                h += `<div class="bg-black/20 p-3 rounded-lg flex justify-between items-center px-6">
                    <span class="text-sm font-bold text-gray-300">${c.key}</span>
                    <button onclick="db.ref('users/${c.key}').remove()" class="text-red-900 hover:text-red-600 text-[10px] font-black uppercase tracking-tighter">Obri≈°i Radnika</button>
                </div>`;
            });
            document.getElementById('adminUsersList').innerHTML = h;
        });
    }

    function decision(id, user, status, color) {
        fetch(WH_PRIJAVA, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({
            embeds: [{ title: "ODLUKA UPRAVE", description: `Korisnik **${user}** je **${status}**.`, color: color }]
        })});
        db.ref('prijave/'+id).remove();
    }

    // IMAGE UPLOAD
    function handleFile(file) {
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (e) => {
            tempImg = e.target.result;
            document.getElementById('preview').src = tempImg;
            document.getElementById('preview').classList.remove('hidden');
        };
        reader.readAsDataURL(file);
    }

    function sendOfficial(type) {
        let t = document.getElementById('annTitle').value;
        let m = document.getElementById('annMsg').value;
        if(!t || !m) return;
        fetch(WH_ADMIN, {
            method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({
                embeds: [{ title: (type==='alert'?'üö® HITNO: ':'üì¢ ')+t, description: m, color: type==='alert'?15158332:16705372 }]
            })
        });
        alert("Poslano u Admin kanal!");
        document.getElementById('annTitle').value = ""; document.getElementById('annMsg').value = "";
        document.getElementById('preview').classList.add('hidden');
    }

    function wipeData(p) { if(confirm("Trajno obrisati: " + p + "?")) db.ref(p).remove(); }

    function syncUser() {
        let u = getU(); if(!u) return;
        db.ref('users/'+fix(u)).on('value', s => {
            document.getElementById('stats').classList.remove('hidden');
            document.getElementById('statHours').innerText = (s.val()?.hours || "0.00") + "h";
        });
    }

    db.ref('users').on('value', s => {
        let h = ''; s.forEach(c => {
            let u = c.val();
            h += `<tr class="border-b border-white/5"><td class="py-4 font-bold">${c.key}</td><td class="${u.status==='Online'?'text-green-500':'text-gray-600'} font-black text-xs uppercase">${u.status||'Offline'}</td><td class="text-right font-black text-blue-500">${u.hours || '0.00'}h</td></tr>`;
        });
        document.getElementById('activeBody').innerHTML = h;
    });

    const dz = document.getElementById('dropZone');
    dz.addEventListener('dragover', (e) => { e.preventDefault(); dz.style.borderColor = "#5865f2"; });
    dz.addEventListener('dragleave', () => { dz.style.borderColor = "#313338"; });
    dz.addEventListener('drop', (e) => { e.preventDefault(); handleFile(e.dataTransfer.files[0]); });
</script>
</body>
</html>
